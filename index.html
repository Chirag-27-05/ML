<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Idea of a Perceptron</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            color: #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        /* Main Section Styles */
        .main-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 5rem 1.25rem;
            width: 100%;
            min-height: 100vh;
        }

        .date {
            color: #6b7280;
            font-size: 0.875rem;
            font-weight: 600;
            letter-spacing: -0.05em;
            margin-bottom: 0.5rem;
        }

        .author {
            color: #6b7280;
            font-size: 1.125rem;
            font-weight: 600;
        }

        .image-container {
            position: relative;
            max-width: 28rem;
            margin-top: 1.25rem;
            overflow: hidden;
        }

        .image-container img {
            width: 100%;
            height: auto;
            transition: transform 1.2s ease-in-out, opacity 1.2s ease-in-out;
            transform: scale(1.1);
            opacity: 0;
        }

        .image-container img.visible {
            transform: scale(1);
            opacity: 1;
        }

        .image-container::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 25%; /* Adjust height as needed */
            background: linear-gradient(to top, from(#fff), to(transparent));
            pointer-events: none;
        }

        .scroll-indicator {
            margin-top: 5rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .scroll-circle {
            width: 2.5rem;
            height: 2.5rem;
            border: 2px solid #6b7280;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            animation: bounce 1s infinite;
        }

        .scroll-dot {
            width: 0.5rem;
            height: 0.5rem;
            background-color: #6b7280;
            border-radius: 50%;
        }

        /* Blog Section Styles */
        .blog-section {
            width: 100%;
            max-width: 48rem;
            padding: 2rem;
            margin-top: 2rem;
            margin-bottom: 8rem;
        }

        .blog-title {
            font-size: 2.2rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 1rem;
            color: #1f2937;
        }

        .blog-content {
            font-size: 1.75rem; /* Increased base font size */
            line-height: 1.6;
            color: #4b5563;
            text-align: center;
            justify-content: center;
        }

        .blog-content p {
            margin-bottom: 1.65rem;
            display: flex;
            flex-wrap: wrap;
            gap: 0.1rem;
        }

        .word{
            position: relative;
            color: rgb(188, 188, 188);
            opacity: 0.4;
            transform: translateY(10px);
            transition: color 0.5s ease-in-out, opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
        }

        .word.reveal{
            color: rgba(0, 0, 0, 1);
            opacity: 1;
            transform: translateY(0);
        }

        .shimmer {
        display: inline-block;
        color: white;
        background: #222222 -webkit-gradient(linear, 100% 0, 0 0, from(#acacac), color-stop(0.5, #ffffff), to(#acacac));
        background-position: -6rem top;
        background-repeat: no-repeat;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        -webkit-animation-name: shimmer;
        -webkit-animation-delay: 0.68s;
        -webkit-animation-duration: 2.2s;
        -webkit-animation-iteration-count: 1;
        -webkit-background-size: 4rem 100%;
      }

      @-webkit-keyframes shimmer {
        0% {
          background-position: -4rem top;
        }
        70% {
          background-position: 23.5rem top;
        }
        100% {
          background-position: 23.5rem top;
        }
      }

        /* Shimmer Animation */
        @-webkit-keyframes shimmer {
            0% { background-position: -4rem top; }
            70% { background-position: 29.5rem top; }
            100% { background-position: 29.5rem top; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
         

          
            .blog-title{
             font-size:1.5rem ; 
             text-align: left;
            }

            .blog-content {
                font-size: 1.2rem;
                text-align:justify;
            }
        }

        @media (max-width: 480px) {
          

          

          .blog-title{
            text-align: left;
             font-size:1.5rem ; 
            }
            .blog-content {
                text-align: justify;
                font-size: 1.2rem;
            }
        }



         /* Audio Control Button Styles */
         .audio-control-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
            color: white;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease-in-out, transform 0.2s ease;
            z-index: 1000;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .audio-control-btn.visible {
            opacity: 1;
        }

        .audio-control-btn:hover {
            transform: scale(1.1);
        }

        .audio-control-btn i {
            font-size: 24px;
        }

        .disable-animations-btn {
            position: fixed;
            bottom: 100px;
            right: 38px;
            width: 50px;
            height: 50px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
            color: white;
            cursor: pointer;
            opacity: 1;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
            z-index: 1000;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .disable-animations-btn:hover {
            transform: scale(1.1);
        }

        .disable-animations-btn i {
            font-size: 18px;
        }

        /* Message Bubble */
        .message-bubble {
            position: fixed;
            bottom: 105px; /* Position above the button */
            right: 95px;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            color: white;
            padding: 10px 15px;
            border-radius: 24px;
            font-size: 14px;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            z-index: 999;
            opacity: 0;
            
        }

        /* Bubble Visible After Delay */
        .message-bubble.show {
            opacity: 1;
            transform: translateY(0);
        }


        .settings-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.90);
        backdrop-filter: blur(12px);
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
        z-index: 998; /* Below the floating buttons */
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding-top: 10vh;
        }

        .settings-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .settings-content {
            position: relative;
            width: 90%;
            max-width: 600px;
        }

        .settings-title {
            color: white;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 2rem;
            opacity: 0;
            transform: translateY(-20px);
            transition: opacity 0.3s ease 0.2s, transform 0.3s ease 0.2s;
        }

        .settings-overlay.visible .settings-title {
            opacity: 1;
            transform: translateY(0);
        }

        .close-btn {
            position: absolute;
            top: 0;
            right: 0;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            opacity: 0;
            transform: rotate(-90deg);
            transition: opacity 0.3s ease 0.3s, transform 0.3s ease 0.3s;
        }

        .settings-overlay.visible .close-btn {
            opacity: 1;
            transform: rotate(0);
        }

        


        .settings-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 2rem;
        }

        .setting-btn {
            
            display: flex;
            padding: 0.45rem 0; /* remove padding from the button*/
            color: white;
            font-size: 1.2rem;
            text-decoration: none;
            position: relative;
            transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1), opacity 0.4s cubic-bezier(0.25, 1, 0.5, 1);
            opacity: 0;
            transform: translateX(-40px);
            border: none;
        }


        .setting-btn::after {
            content: '';
            position: absolute;
            bottom: 0; /* Changed bottom to 0 to align it right below the text */
            left: 0; /* Added Left to be 0 for start of text */
            height: 1px; /* made it 1 px */
            background-color: white;
                width: auto; /* changed width to auto*/
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        
        }
        .setting-btn::before {
        content: '\2192';
        position: absolute;
            right: 0%;  /* adjust positioning based on padding */
            top: 50%;
            transform: translateY(-50%) rotate(0deg); /* rotate to 0 initially */
            font-size: 1.2rem;
            opacity: 0;
            transition:  opacity 0.3s ease, transform 0.3s ease;
        }
        .settings-overlay.visible .setting-btn {
        opacity: 1;
            transform: translateX(0);
            transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1) 0.2s, opacity 0.4s cubic-bezier(0.25, 1, 0.5, 1) 0.2s;

            }

        .setting-btn:hover::after,
        .setting-btn:focus::after {
                transform: scaleX(1);
            }
        .setting-btn:hover::before,
        .setting-btn:focus::before{
                opacity: 1;
                transform: translateY(-50%) rotate(-45deg); /* rotation to 45deg on hover*/
            }
            .setting-btn:hover,
            .setting-btn:focus {
                color: #dddddd; /* change color and not background on hover */
                padding:  0.45rem 0.5rem; /* add padding on hover */
            }
        /* Video Player Styles */
        .video-player-container {
            position: relative;
            width: 1920px/2;
            height: 1080px/2;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            margin-top: 2rem;
            border-radius: 10px; /* Added border radius */
            background: transparent;
            margin-top: 40px;
            margin-bottom: 40px;
        }

        .video-player-container.visible {
            opacity: 1;
        }

        .video-background {
            position: absolute;
            inset: 0;
            border-radius: 10px; /* Added border radius */
            background-color: rgba(0, 0, 0, 0.3);
            filter: blur(8px);
            z-index: 499;
        }

        .video-element {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 10px; /* Added border radius */
            z-index: 500;
        }

        .video-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem;
            background-color: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            gap: 1rem;
            z-index: 501;

        }

        .video-controls.hidden {
        opacity: 0;
        pointer-events: none; /* Prevent interaction when hidden */
        transition: opacity 0.3s ease-in-out;
        }

        .control-button {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .control-button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .control-button i {
            color: white;
            font-size: 1.2rem;
        }

        .video-seeker {
            flex: 1;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
        }

        .video-seeker::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
        }

        body .blog-section .video-player-container.visible { /* Add more context */
            opacity: 1;
        }

        @media (max-width: 768px) {
            .video-player-container {
                height: 60vh;
            }
        }

        

    </style>
</head>
<body>
  <main class="flex flex-col items-center justify-center text-center p-5 w-full min-h-screen pt-20">
    <!-- Date -->
    <p class="text-gray-600 text-sm font-semibold tracking-tight mb-2">16/12/2024</p>

    <!-- Title and Author -->
    <div class="mb-5">
      <h1 class=" text-3xl font-bold shimmer mb-1 tracking-tighter">
        The Idea Of A Perceptron
      </h1>

      <p class="text-gray-600 text-lg font-semibold">Chirag Jalade</p>
    </div>

    <!-- New Text Divs with Icons -->
    <div class="flex justify-center space-x-8 mb-0">
      <!-- Read the Docs -->
      <div class="flex items-center space-x-2 text-gray-600 hover:text-black cursor-pointer">
        <!-- Book Icon -->
        <i class="fas fa-file-alt text-black text-sm"></i>
        <span class="text-lg">Read the Docs</span>
      </div>
      <!-- Read References -->
      <div class="flex items-center space-x-2 text-gray-600 hover:text-black cursor-pointer">
        <!-- File Icon -->
        <i class="fas fa-university text-black text-sm"></i>
        <span class="text-lg">Read References</span>
      </div>
    </div>

    <!-- Image Container -->
    <div class="image-container relative flex justify-center items-center max-w-md mt-5">
      <img
        src="images/perceptron.png"
        alt="Perceptron Visual Representation"
        class="w-full h-auto block"
      />
      <div
        class="absolute bottom-0 w-full h-1/4 bg-gradient-to-t from-white to-transparent pointer-events-none"
      ></div>
    </div>

    <!-- Scroll Down Circle -->
    <div class="mt-20 flex justify-center items-center">
      <div class="animate-bounce w-10 h-10 border-2 border-gray-600 rounded-full flex items-center justify-center">
        <div class="w-2 h-2 bg-gray-600 rounded-full"></div>
      </div>
    </div>
  </main>

    <section class="blog-section">
        <h2 class="blog-title">The Birth of the Perceptron</h2>
        <div class="blog-content">
            <p id="para1">The perceptron, introduced by Frank Rosenblatt in 1958, was inspired by the structure and function of the biological neuron. Neurons in the human brain process information by receiving input signals through dendrites, performing computations in the cell body, and transmitting outputs via axons. Similarly, a perceptron takes input values, applies weights, sums them, and passes the result through an activation function to produce an output.</p>
            <p id="para2">Rosenblatt's perceptron was a significant milestone in the field of artificial intelligence. It was the first algorithmically described neural network model, capable of learning and recognizing patterns from data. This simple yet profound model laid the groundwork for modern deep learning networks, demonstrating how machines could mimic human-like decision-making inspired by the brain's neuron structure.</p>
            <p id="para3">While the original perceptron was limited to solving linear problems, its foundational principles evolved into multi-layered networks capable of solving complex, non-linear tasks. Today, the perceptron's legacy lives on in the AI systems we interact with every day.</p>

            
            <!-- Add Video Player Container -->
            <div class="video-player-container">
                <div class="video-background"></div>
                <video class="video-element">
                    <source class="large-screen-video" src="videos/large.mp4" media="(min-width: 769px)" type="video/mp4">
                    <source class="small-screen-video" src="videos/small.mp4" media="(max-width: 768px)" type="video/mp4">
                </video>
                <div class="video-controls">
                    <button class="control-button mute-unmute">
                        <i class="fas fa-volume-up"></i>
                    </button>
                    <input type="range" class="video-seeker" min="0" max="100" value="0">
                </div>
            </div>

            <p id="para4">While the original perceptron was limited to solving linear problems, its foundational principles evolved into multi-layered networks capable of solving complex, non-linear tasks. Today, the perceptron's legacy lives on in the AI systems we interact with every day.</p>
            
        </div>
    </section>

    <div class="audio-control-btn">
        <i class="fas fa-play"></i>
    </div>

    <!-- Disable Animations Button -->
    <div class="disable-animations-btn">
        <i class="fas fa-magic"></i>
    </div>


    <div id="messageBubble" class="message-bubble">
        Enable Or Disable Animations
    </div>

    <!-- Settings Overlay -->
       <!-- Settings Overlay -->
   <div id="settingsOverlay" class="settings-overlay">
    <div class="settings-content">
        <h2 class="settings-title">Settings</h2>
        <!-- Settings Buttons -->
         <div class="settings-buttons">
            <a href="https://chiragjalade.com/blog" class="setting-btn">Blog Home</a>
            <a href="https://chiragjalade.com/about" class="setting-btn">About Me</a>
            <a href="https://chiragjalade.com/contact" class="setting-btn">Contact</a>
        </div>
        <button id="closeSettings" class="close-btn">
            <i class="fas fa-times"></i>
        </button>
    </div>
</div>
    

    <script>
        // Wait for the page to load completely
        window.addEventListener("load", function() {
            const messageBubble = document.getElementById("messageBubble");
            // Show the message bubble after a 1-second delay
            setTimeout(function() {
                messageBubble.classList.add("show");
            }, 1000);
    
            // Add scroll event listener to hide the message bubble
            let scrollTimeout;
            window.addEventListener("scroll", function() {
                // Clear any existing timeout
                clearTimeout(scrollTimeout);
    
                // Hide the message bubble
                messageBubble.classList.remove("show");
    
                // Optional: Remove the element completely after animation finishes
                scrollTimeout = setTimeout(function() {
                    messageBubble.style.display = "none";
                }, 500); // Wait for fade out animation to complete
            });
        });
    
        // Image Reveal
        document.addEventListener("DOMContentLoaded", function () {
            const img = document.querySelector(".image-container img");
            const revealImage = () => {
                const rect = img.getBoundingClientRect();
                if (rect.top < window.innerHeight && rect.bottom >= 0) {
                    img.classList.add("visible");
                    window.removeEventListener("scroll", revealImage);
                }
            };
            window.addEventListener("scroll", revealImage);
            revealImage();
        });
    
        document.addEventListener("DOMContentLoaded", function () {
            const audioControlBtn = document.querySelector('.audio-control-btn');
            const icon = audioControlBtn.querySelector('i');
            const blogContent = document.querySelector('.blog-content');
            const videoContainer = document.querySelector('.video-player-container');
            const video = document.querySelector('.video-element');
            let isVideoVisible = false;
            const playSound = new Audio('sfx/play.mp3');
            const videoControls = videoContainer.querySelector('.video-controls'); // get controls element
    
    
            const audioFiles = [
                'audio/one.mp3',
                'audio/two.mp3',
                'audio/three.mp3',
                'audio/three.mp3'  // added the fourth audio
            ];
    
            let currentAudio = null;
            let isPlayingAudio = false;
            let currentParagraphIndex = -1;
            let animationTimeout = null;
            let currentWordIndex = 0;
            let lastScrollTop = 0; // Track scroll direction
            let animationsEnabled = true;
    
            // Create style tag for animation disabled state
            const styleTag = document.createElement('style');
            document.head.appendChild(styleTag);
            styleTag.textContent = `
                .blog-content.animations-disabled {
                    position: relative;
                }
    
                .blog-content.animations-disabled::after {
                    content: '';
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: white;
                    pointer-events: none;
                    z-index: 1;
                }
    
                .blog-content.animations-disabled .text-overlay {
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    z-index: 2;
                    background: transparent;
                }
    
                .blog-content.animations-disabled > p {
                    position: relative;
                    z-index: 0;
                }
    
                .blog-content.animations-disabled .text-overlay p {
                    color: black;
                    margin-bottom: 1.65rem;
                }
    
                .blog-content.animations-disabled .text-overlay .word {
                    color: black !important;
                    opacity: 1 !important;
                    transform: translateY(0) !important;
                    position: relative;
                    display: inline-block;
                }
            `;
    
            // Create text overlay element
            const textOverlay = document.createElement('div');
            textOverlay.className = 'text-overlay';
    
            const blogSection = document.querySelector('.blog-section');
            const paragraphs = document.querySelectorAll('.blog-content p'); // dynamic paragraph selection
    
            // Function to wrap words in spans
            function wrapWordsInSpans() {
                paragraphs.forEach(paragraph => {
                    const words = paragraph.textContent.split(/\s+/);
                    paragraph.innerHTML = words.map(word =>
                        `<span class="word">${word}Â </span>`
                    ).join('');
                });
            }
    
            // Wrap words initially
            wrapWordsInSpans();
    
            // Function to show or hide the floating button
            function toggleAudioButtonVisibility() {
                const rect = blogSection.getBoundingClientRect();
                const windowHeight = window.innerHeight;
    
                if (rect.top < windowHeight && rect.bottom >= 0) {
                    audioControlBtn.classList.add('visible');
                } else {
                    audioControlBtn.classList.remove('visible');
                    if (currentAudio) currentAudio.pause();
                    resetAudioControlIcon();
                }
            }
    
            // Function to reset audio control button icon
            function resetAudioControlIcon() {
                icon.classList.remove('fa-pause');
                icon.classList.add('fa-play');
                isPlayingAudio = false;
                if (animationTimeout) {
                    clearTimeout(animationTimeout);
                    animationTimeout = null;
                }
            }
    
            // Function to animate the paragraph and play audio
           async function animateParagraph(paragraphElement, audioPath, paragraphIndex) { // Modified function
                if (paragraphElement.classList.contains('animating')) {
                    return;
                }
                paragraphElement.classList.add('animating');
                if (currentAudio) {
                    currentAudio.pause();
                }
                const words = paragraphElement.querySelectorAll('.word');
                currentWordIndex = 0;
                 if (audioPath){
                    currentAudio = new Audio(audioPath);
                     currentAudio.preload = 'auto';
                     currentAudio.muted = true;
                 }
                 else{
                     currentAudio = null;
                 }
    
                currentParagraphIndex = paragraphIndex;
                icon.classList.remove('fa-play');
                icon.classList.add('fa-pause');
                isPlayingAudio = true;
    
                async function revealWord(index) {
                    if (!isPlayingAudio) return;
                    if (index < words.length) {
                        words[index].classList.add('reveal');
                        currentWordIndex = index + 1;
                        if (isPlayingAudio) {
                            animationTimeout = setTimeout(() => {
                                revealWord(index + 1);
                            }, 180);
                        }
                    }
                }
    
                function audioEndHandler() {
                    icon.classList.remove('fa-pause');
                    icon.classList.add('fa-play');
                    isPlayingAudio = false;
                      if(currentAudio)
                         currentAudio.removeEventListener('ended', audioEndHandler);
                }
               if(currentAudio)
                    currentAudio.addEventListener('ended', audioEndHandler);
    
                try {
                    if(currentAudio)
                     await currentAudio.play();
                     if(currentAudio)
                       currentAudio.muted = false;
                } catch (error) {
                    console.warn('Autoplay blocked, waiting for user interaction.', error);
                     if(currentAudio)
                        document.addEventListener('click', function resumeAudio() {
                         currentAudio.play();
                           currentAudio.muted = false;
                         document.removeEventListener('click', resumeAudio);
                         });
                }
    
                await revealWord(0);
                paragraphElement.classList.remove('animating');
            }
    
            // Function to reset paragraph animation with reverse sequential effect
            function resetParagraphAnimation(paragraph) {
                const words = Array.from(paragraph.querySelectorAll('.word'));
                words.reverse().forEach((word, index) => {
                    setTimeout(() => {
                        word.classList.remove('reveal');
                    }, index * 50);
                });
            }
    
            // Improved viewport detection
            function isElementReadyForReset(paragraph) {
            const rect = paragraph.getBoundingClientRect();
            const lineHeight = parseInt(window.getComputedStyle(paragraph).lineHeight);
            const totalLines = Math.ceil(rect.height / lineHeight);
            const lastLinePosition = rect.top + (totalLines * lineHeight);
    
            // Check if the last line has just met the bottom of the viewport
            return lastLinePosition <= window.innerHeight + lineHeight && lastLinePosition >= window.innerHeight - lineHeight;
        }
    
        // Keep the original isElementInViewport for animation entry
        function isElementInViewport(el) {
            const rect = el.getBoundingClientRect();
            const threshold = window.innerHeight * 0.3;
            return !(rect.bottom < threshold || rect.top > (window.innerHeight - threshold));
        }
    
        const observedParagraphs = new Set();
    
       async function checkParagraphsInView() { // Modified check paragraphs function
            const st = window.pageYOffset || document.documentElement.scrollTop;
            const scrollingUp = st < lastScrollTop;
            lastScrollTop = st;
           for (let i = 0; i < paragraphs.length; i++) {
               const paragraph = paragraphs[i];
                const isInView = isElementInViewport(paragraph);
               const shouldReset = isElementReadyForReset(paragraph);
                const audioPath = audioFiles[i]; // Dynamically get audio file
               if (scrollingUp && observedParagraphs.has(paragraph) && shouldReset) {
                    resetParagraphAnimation(paragraph);
                    observedParagraphs.delete(paragraph);
                    if (currentAudio && currentParagraphIndex === i) {
                     if(currentAudio)
                        currentAudio.pause();
                        resetAudioControlIcon();
                    }
                } else if (isInView && !observedParagraphs.has(paragraph) && !scrollingUp) {
                   observedParagraphs.add(paragraph);
                   await animateParagraph(paragraph, audioPath, i);
                }
           }
        }
            // Improved scroll handling
            let scrollTimeout;
            function onScroll() {
                if (scrollTimeout) {
                    cancelAnimationFrame(scrollTimeout);
                }
                scrollTimeout = requestAnimationFrame(() => {
                    toggleAudioButtonVisibility();
                    checkParagraphsInView();
                });
            }
    
            // Audio control button behavior
            const pauseSound = new Audio('sfx/pause.mp3');
    
            // Intersection Observer for video visibility
            const videoObserver = new IntersectionObserver(
                (entries) => {
                    entries.forEach(entry => {
                        console.log("Video Container Intersection:", entry.isIntersecting, entry.target);
                        isVideoVisible = entry.isIntersecting;
                        if (isVideoVisible) {
                            videoContainer.classList.add('visible');
                            showControls();  // show controls when video is visible
                            startAutoHideTimer(); // set auto-hide timer
                        } else {
                            videoContainer.classList.remove('visible');
                        }
                    });
    
                },
                { threshold: 0 }
            );
            videoObserver.observe(videoContainer);
    
             // Function to show video controls
             function showControls() {
                videoControls.classList.remove('hidden');
            }
    
            // Function to hide video controls
            function hideControls() {
               videoControls.classList.add('hidden');
            }
    
    
            let autoHideTimer;
            // Function to start auto-hide timer
            function startAutoHideTimer() {
                if(autoHideTimer) clearTimeout(autoHideTimer);
                autoHideTimer = setTimeout(hideControls, 1500); // Hide after 1.5 seconds
            }
    
            // Event listener for click on video container to show controls
            videoContainer.addEventListener('click', function(){
                showControls(); // show on click
                 startAutoHideTimer(); // reset timer
            });
    
            // hide controls initially on load
            videoControls.classList.add('hidden');
    
    
    
            audioControlBtn.addEventListener('click', () => {
                if (isVideoVisible) {
                    if (video.paused) {
                        video.play();
                        icon.classList.remove('fa-play');
                        icon.classList.add('fa-pause');
                    } else {
                        video.pause();
                        icon.classList.remove('fa-pause');
                        icon.classList.add('fa-play');
                    }
                } else {
                      if (currentAudio) {
                        if (isPlayingAudio) {
                            currentAudio.pause();
                            resetAudioControlIcon();
                            pauseSound.play();
                        } else {
                            currentAudio.play();
                            icon.classList.remove('fa-play');
                            icon.classList.add('fa-pause');
                            isPlayingAudio = true;
                            playSound.play();
                            const currentParagraph = paragraphs[currentParagraphIndex];
                            if (currentParagraph) {
                                const words = currentParagraph.querySelectorAll('.word');
                                async function resumeAnimation(index) {
                                    if (!isPlayingAudio) return;
                                    if (index < words.length) {
                                        words[index].classList.add('reveal');
                                        currentWordIndex = index + 1;
                                        if (isPlayingAudio) {
                                            animationTimeout = setTimeout(() => {
                                                resumeAnimation(index + 1);
                                            }, 180);
                                        }
                                    }
                                }
                                resumeAnimation(currentWordIndex);
                            }
                        }
                    }
                }
            });
    
            // Disable animations button functionality
            const disableAnimationsBtn = document.querySelector('.disable-animations-btn');
    
            disableAnimationsBtn.addEventListener('click', () => {
                animationsEnabled = !animationsEnabled;
    
                if (!animationsEnabled) {
                    blogContent.classList.add('animations-disabled');
                    textOverlay.innerHTML = blogContent.innerHTML;
                    blogContent.appendChild(textOverlay);
                    textOverlay.querySelectorAll('.word').forEach(word => {
                        word.classList.add('reveal');
                    });
                } else {
                    blogContent.classList.remove('animations-disabled');
                    if (textOverlay.parentElement === blogContent) {
                        blogContent.removeChild(textOverlay);
                    }
                }
            });
    
            // Initial checks
            window.addEventListener('scroll', onScroll);
            window.addEventListener('resize', onScroll);
            toggleAudioButtonVisibility();
            checkParagraphsInView();
        });
    
        // Add this to your existing DOMContentLoaded event listener
        document.addEventListener("DOMContentLoaded", function() {
            // ... your existing code ...
    
            // Settings overlay functionality
            const disableAnimationsBtn = document.querySelector('.disable-animations-btn');
        const settingsOverlay = document.getElementById('settingsOverlay');
        const closeSettingsBtn = document.getElementById('closeSettings');
         const settingBtns = document.querySelectorAll('.setting-btn')
          const settingsTitle = document.querySelector('.settings-title')
        
        let pressTimer;
        let isPressing = false;

        // Handle long press
        disableAnimationsBtn.addEventListener('mousedown', startPress);
        disableAnimationsBtn.addEventListener('touchstart', startPress, { passive: true });
        
        disableAnimationsBtn.addEventListener('mouseup', endPress);
        disableAnimationsBtn.addEventListener('mouseleave', endPress);
        disableAnimationsBtn.addEventListener('touchend', endPress);
        disableAnimationsBtn.addEventListener('touchcancel', endPress);

        function startPress(e) {
            isPressing = true;
            pressTimer = setTimeout(() => {
                if (isPressing) {
                    showSettingsOverlay();
                }
            }, 1200); // 1.2 second delay
        }

        function endPress() {
            isPressing = false;
            clearTimeout(pressTimer);
        }

        function showSettingsOverlay() {
           settingsOverlay.classList.add('visible');
            settingsTitle.style.opacity = '1'
            settingsTitle.style.transform = 'translateY(0)'
            settingBtns.forEach((btn, index) => {
                 setTimeout(() => {
                   btn.style.opacity = '1'
                   btn.style.transform = 'translateX(0)'
                 }, index * 100);
               })
        }

        function hideSettingsOverlay(){
            settingsOverlay.classList.remove('visible');
             settingsTitle.style.opacity = '0'
            settingsTitle.style.transform = 'translateY(-20px)'
        }

        // Close overlay when clicking the close button
        closeSettingsBtn.addEventListener('click', () => {
            settingBtns.forEach((btn, index) => {
                 setTimeout(() => {
                     btn.style.opacity = '0'
                     btn.style.transform = 'translateX(-20px)'
                   }, index * 50);
               })
                 setTimeout(hideSettingsOverlay, 250);
         });

        // Optional: Close overlay when clicking outside the content
        settingsOverlay.addEventListener('click', (e) => {
            if (e.target === settingsOverlay) {
                settingBtns.forEach((btn, index) => {
                 setTimeout(() => {
                     btn.style.opacity = '0'
                     btn.style.transform = 'translate(-20px)'
                   }, index * 50);
               })
               setTimeout(hideSettingsOverlay, 250);
            }
        });
        });
    
        document.addEventListener("DOMContentLoaded", function() {
            const videoContainer = document.querySelector('.video-player-container');
            const video = document.querySelector('.video-element');
            const muteBtn = document.querySelector('.mute-unmute');
            const seeker = document.querySelector('.video-seeker');
    
            // Mute functionality
            muteBtn.addEventListener('click', () => {
                if (video.muted) {
                    video.muted = false;
                    muteBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                } else {
                    video.muted = true;
                    muteBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
                }
            });
    
            // Update seeker
            video.addEventListener('timeupdate', () => {
                const progress = (video.currentTime / video.duration) * 100;
                seeker.value = progress;
            });
    
            // Seek video
            seeker.addEventListener('change', () => {
                const time = (seeker.value / 100) * video.duration;
                video.currentTime = time;
            });
        });
    </script>
</script>
    
</body>
</html>
